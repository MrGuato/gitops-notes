---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const base = import.meta.env.BASE_URL.replace(/\/$/, "");
const posts = (await getCollection("posts")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<BaseLayout title="Writing">
  <section class="hero">
    <h1>Writing</h1>
    <p>All build logs and notes, published through Git.</p>
  </section>

  <section class="grid">
    {posts.map((p) => (
      <a class="card" href={`${base}/writing/${p.slug}`}>
        <div class="card-body">
          <div class="meta">
            {p.data.date.toLocaleDateString("en-US", {
              year: "numeric",
              month: "short",
              day: "numeric",
            })}
          </div>
          <h2>{p.data.title}</h2>
          <p>{p.data.description}</p>
        </div>

        {p.data.hero ? (
          <img
            class="thumb"
            src={`${base}/${p.data.hero}`}
            alt=""
            loading="lazy"
          />
        ) : null}
      </a>
    ))}
  </section>
</BaseLayout>